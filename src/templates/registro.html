<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro de Rostos - Voluntários Cajuru</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/app.css') }}" />
    <meta name="color-scheme" content="light">
  </head>
<body data-page="registro" data-source="local">
    <header class="header">
        <div class="title">Cadastro de Rostos — Voluntários Hospital do Cajuru</div>
    </header>
    <main class="container">
        <div id="overlay-training" class="overlay-training hidden" aria-hidden="true">
            <h3>Atualizando modelo de reconhecimento</h3>
            <div class="progress-track"><div class="progress-bar"></div></div>
            <div class="training-msg" id="training-text">Isso pode levar alguns segundos dependendo da quantidade de imagens...</div>
            <button type="button" class="btn secondary" id="btn-cancel-train" style="margin-top:22px; display:none;" disabled>Cancelar</button>
        </div>
        <div class="step-indicator" id="etapa">Etapa 1 de 2 — Dados do voluntário</div>
        <div class="grid">
            <section class="panel" id="form-panel">
                <h2>Dados do Voluntário</h2>
                <form id="form-cadastro" autocomplete="off">
                    <div class="group">
                        <label for="nome-pessoa">Nome completo *</label>
                        <input id="nome-pessoa" name="nome" required placeholder="Fulano de Tal" />
                    </div>
                    <div class="group">
                        <label for="cpf-pessoa">CPF *</label>
                        <input id="cpf-pessoa" name="cpf" required maxlength="14" placeholder="000.000.000-00" />
                    </div>
                    <div class="group">
                        <label for="matricula-pessoa">Matrícula *</label>
                        <input id="matricula-pessoa" name="matricula" required placeholder="Identificador interno" />
                    </div>
                    <div class="group">
                        <label for="email-pessoa">Email (opcional)</label>
                        <input id="email-pessoa" name="email" type="email" placeholder="email@exemplo.com" />
                    </div>
                </form>
                <div class="actions">
                    <button class="btn" id="btn-verificar" type="button">Verificar / Continuar</button>
                    <button class="btn secondary" id="btn-reset" type="button" style="display:none;">Novo cadastro</button>
                </div>
                <div id="status-messages"></div>
            </section>
            <section class="panel" id="capture-panel" style="display:none;">
                <h2>Captura de Fotos</h2>
                <div class="video-wrap">
                    <div class="camera-status loading" id="camera-status" style="display:none;">Inicializando câmera...</div>
                    <video id="video-stream" autoplay playsinline></video>
                    <canvas id="canvas" style="display:none;"></canvas>
                </div>
                <div class="instructions">
                    <ul>
                        <li>Mantenha o rosto centralizado e bem iluminado.</li>
                        <li>Evite sombras fortes ou contraluz.</li>
                        <li>Capture diversas fotos variando levemente ângulo e expressão.</li>
                        <li>Recomendado: 10–15 fotos para melhor qualidade.</li>
                    </ul>
                </div>
                <div class="actions">
                    <button class="btn" id="btn-capturar" type="button" disabled>Capturar Foto</button>
                    <button class="btn secondary" id="btn-finalizar" type="button" disabled>Finalizar</button>
                </div>
                <div class="capture-count" id="capture-counter">Nenhuma foto capturada ainda.</div>
            </section>
        </div>
        <section class="panel" style="margin-top:24px;">
            <h2>Registros Existentes</h2>
            <div id="pessoas-lista" class="list-reg">
                <div class="list-item"><span>Carregando...</span></div>
            </div>
        </section>
        <div style="margin-top:16px;">
            <a href="{{ url_for('index') }}" class="btn secondary">Voltar para reconhecimento</a>
        </div>
    </main>
    <footer class="footer">
        <div class="inner">Hospital do Cajuru — Sistema de reconhecimento (captura de rostos)</div>
    </footer>
    <script type="module" src="{{ url_for('static', filename='js/registro.js') }}"></script>
</body>
</html>